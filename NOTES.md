# Notes

## Weather

There are several different APIs available for retrieving current weather conditions and forecasts:

1. [Weather Underground](https://www.wunderground.com/weather/api/d/docs?MR=1)

### 1) Weather Underground

WU serves data over HTTP via JSON or XML. They offer a free service accessible with an API key, which you can get for free. I signed up for the "Anvil Plan" with limited ("Developer") access, and received an API key to use (saved in [wu.key]())

## d3.js

d3.js is a mature, full-fledged graphics/visualization library for Javascript. It doesn't play very nicely with Python, but as long as you can process your data into the JSON or CSV format it expects, then everything is hunky-dory. To generate a figure with d3.js, you need to run a webapp to serve up the data and feed it to a web browser client.

### npm -> svg

The attached sample script, `svgcreator.node.js`, wraps a Node.js package called "jsdom" which allows the programmatic creation of web content from CLI scripts. If you run the script,

```
$ node svgcreator.node.js
```

you'll see the code for an SVG printed to the console. By re-directing this and capturing it in an SVG file, you now have a stand-alone copy of the rendered graphic! Furthermore, the SVG can be converted to a PNG or a PDF using ImageMagick (note the caveat [here](http://stackoverflow.com/questions/9853325/how-to-convert-a-svg-to-a-png-with-image-magick) about installing librsvg):

```
$ node svgcreator.node.js > test.svg
$ convert test.svg test.png
```

I added a set of pattern rules to the Makefile which shortcuts this process. Now, any figure can be generated by invoking `make {figure}.png`, where **{figure}** correspond to the name of the script used to generate it. Alternatively, since we're succumbing to node, we can use the [svgexport package](https://github.com/shakiba/svgexport)

Currently, the sticking point is serving CSV in the Node.js ecosystem. I'm not sure how to deal with that just yet.

## Resources

- [d3.js + Flask sample app](http://adilmoujahid.com/posts/2015/01/interactive-data-visualization-d3-dc-python-mongodb/)
- [Full Stack Development - Fetching Data, Visualizing With D3, and Deploying With Dokku](https://realpython.com/blog/python/web-development-with-flask-fetching-data-with-requests/)
